<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Basket Rhythm Game</title>
<style>
    body { 
        margin: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        background: #222;
        height: 100vh;
        overflow: hidden;
        color: white;
        font-family: sans-serif;
    }

    #circle {
        width: 300px;
        height: 300px;
        border-radius: 50%;
        background: red;
        margin-top: 40px;

        /* ★アニメーションを滑らかにする */
        transition: transform 0.15s ease-out;
    }

    #controls {
        margin-top: 20px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
    }

    button, select, input {
        font-size: 20px;
        padding: 10px 20px;
    }
        
</style>
</head>
<body>
    <img src="logo.png" class="logo">

<h2>5HoopsIQ</h2>

<div id="circle"></div>

<div id="controls">
    <label>BPM:
        <input id="bpmInput" type="number" value="60" min="60" max="100" step="5">
    </label>

    <label>色モード:
        <select id="colorMode">
            <option value="2">2色（赤・青）</option>
            <option value="3">3色（赤・青・緑）</option>
            <option value="4">4色（赤・青・緑・黄）</option>
        </select>
    </label>

    <button id="startBtn">スタート</button>
    <button id="stopBtn">ストップ</button>
</div>

<script>
let intervalId = null;

// ★ホイッスル音
const whistle = new Audio("whistle.mp3"); 
// ※ whistle.mp3 を同じフォルダに入れるだけでOK

// 色セット
const colorSets = {
    2: ["red", "blue"],
    3: ["red", "blue", "green"],
    4: ["red", "blue", "green", "yellow"]
};

function startRhythm() {
    const bpm = parseInt(document.getElementById("bpmInput").value);
    const mode = document.getElementById("colorMode").value;
    const colors = colorSets[mode];

    const circle = document.getElementById("circle");

    if (intervalId) clearInterval(intervalId);

    const interval = 60000 / bpm;

    intervalId = setInterval(() => {

        // --- ホイッスル音を鳴らす ---
        whistle.currentTime = 0;
        whistle.play();

        // --- 色変更 ---
        const color = colors[Math.floor(Math.random() * colors.length)];
        circle.style.background = color;

        // --- 改良アニメーション ---
        // 音 → 一気に縮む
        circle.style.transform = "scale(0.55)";

        // 半拍程度でバウンドして戻る
        setTimeout(() => {
            circle.style.transform = "scale(1.15)";
        }, interval * 0.15);

        setTimeout(() => {
            circle.style.transform = "scale(1)";
        }, interval * 0.25);

        setTimeout(() => {
            circle.style.transform = "scale(1.15)";
        }, interval * 0.35);

        setTimeout(() => {
            circle.style.transform = "scale(1)";
        }, interval * 0.45);


    }, interval);
}

document.getElementById("startBtn").onclick = () => {
    startRhythm();
};

document.getElementById("stopBtn").onclick = () => {
    if (intervalId) clearInterval(intervalId);

    const circle = document.getElementById("circle");
    circle.style.transform = "scale(1)";
};
</script>

</body>
</html>
